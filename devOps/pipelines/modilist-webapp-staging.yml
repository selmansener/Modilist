# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

trigger: none

pool:
  vmImage: ubuntu-latest

steps:
- task: NodeTool@0
  displayName: 'Nodejs Installation'
  inputs:
    versionSpec: '16.x'
    checkLatest: true
- task: Npm@1
  displayName: 'Instal Packages'
  inputs:
    command: 'install'
    workingDir: 'src/frontend/webapp/modilist'
- script: REACT_APP_ENV=staging node scripts/start.js
  displayName: Build
  name: build
  workingDirectory: 'src/frontend/webapp/modilist'
# - task: Npm@1
#   inputs:
#     command: 'custom'
#     workingDir: 'src/frontend/webapp/modilist'
#     customCommand: 'run build:staging'
- task: AzureStaticWebApp@0
  displayName: Deploy
  inputs:
    app_location: 'src/frontend/webapp/modilist/build'
    output_location: 'src/frontend/webapp/modilist/build'
    config_file_location: 'src/frontend/webapp/modilist/build'
    skip_app_build: true
    azure_static_web_apps_api_token: '8eab9aaeace4326c07773c670fd678f1ffec332601a24f69f3d66eb9dc34e6931-6e8d34d7-e5b4-4ee7-be73-72ce6d0a085400391955'
